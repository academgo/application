import { BlockContentWithStyle, OfferBlock } from "@/types/blog";
import { PortableText } from "@portabletext/react";
import { RichText } from "../RichText/RichText";
import React, { FC } from "react";
import styles from "./OfferBlockComponent.module.scss";
import FormSuperLite from "../FormSuperLite/FormSuperLite";
import Link from "next/link";
import Image from "next/image";
import { urlFor } from "@/sanity/sanity.client";
import { ButtonModal } from "../ButtonModal/ButtonModal";

type Props = {
  block: OfferBlock;
};

const OfferBlockComponent: FC<Props> = ({ block }) => {
  const getBlockStyle = (textBlock?: BlockContentWithStyle) => ({
    background: textBlock?.backgroundColor || "transparent",
    border: textBlock?.isBorder ? "1px solid #000" : "none",
    padding: textBlock?.backgroundColor ? "25px" : "0",
    borderRadius: textBlock?.backgroundColor ? "20px" : "0"
  });

  // console.log("OfferBlock data:", block);
  // console.log("OfferForm:", block.offerForm);

  return (
    <section className={styles.offer}>
      <div className="container">
        <div className={styles.offerWrapper}>
          <svg
            className={styles.decor}
            xmlns="http://www.w3.org/2000/svg"
            width="724"
            height="444"
            viewBox="0 0 724 444"
            fill="none"
          >
            <path
              d="M38.0849 473.047L17.0849 471.847L17.6849 461.347C19.6849 427.247 29.2849 403.947 47.1849 390.047C60.1849 379.947 76.0849 375.947 91.4849 372.047C105.085 368.647 117.385 365.547 125.685 358.847C118.685 352.747 112.785 343.747 108.585 332.547C101.285 313.147 108.185 303.147 112.885 298.947C121.485 291.247 135.485 291.847 144.785 300.247C150.785 305.647 154.485 313.347 156.185 323.847C157.285 330.347 157.785 338.947 155.785 347.847C167.685 348.647 185.385 349.247 196.685 345.047C233.485 331.247 234.285 296.547 233.685 286.347C232.685 269.247 223.185 253.747 209.585 246.847C196.885 240.447 180.585 240.947 166.285 241.347C163.385 241.447 160.285 241.547 157.085 241.647C122.285 242.947 69.7849 245.047 31.9849 216.047C8.58487 198.047 1.88487 175.847 0.384871 160.347C-1.71513 139.347 4.88487 117.347 17.5849 102.947C36.5849 81.3469 66.5849 69.3469 106.685 67.2469C114.385 66.8469 122.285 67.9469 130.685 69.1469C150.985 72.0469 171.885 74.9469 193.685 57.1469C198.585 53.1469 202.485 47.5469 206.685 41.6469C210.285 36.5469 214.085 31.2469 218.785 26.4469C231.285 13.6469 242.585 5.94691 254.185 2.34691C267.985 -1.85309 282.085 -0.453087 297.285 6.84691C310.185 12.9469 313.785 24.5469 316.785 33.8469C320.685 46.1469 323.285 54.3469 345.085 55.5469C354.885 56.1469 364.385 60.7469 371.985 68.7469C378.985 76.0469 383.585 85.3469 384.985 94.9469C389.185 122.647 365.285 144.447 352.485 156.247C327.585 179.147 326.985 191.447 328.685 198.847L328.785 199.247C329.085 200.547 329.985 204.547 342.885 206.447C358.585 208.747 363.185 200.947 372.185 177.747C379.185 159.747 387.985 137.447 411.785 128.947C424.985 124.247 445.485 124.947 458.985 135.347C468.185 142.347 472.685 152.847 471.785 164.747C470.585 179.547 460.385 194.547 452.185 206.547C449.185 211.047 445.985 215.647 444.985 218.047C433.985 243.647 436.085 262.447 451.285 273.847C475.285 292.047 522.585 287.547 534.785 277.747C541.885 272.047 546.885 263.847 552.285 255.147C564.385 235.347 579.485 210.747 624.885 208.447C661.485 206.547 689.385 206.247 712.985 207.447L723.485 207.947L722.485 228.947L711.985 228.447C689.185 227.347 661.885 227.647 626.085 229.447C591.785 231.147 581.785 247.347 570.285 266.147C564.285 275.947 557.985 286.147 548.085 294.147C528.485 309.947 470.585 314.747 438.685 290.647C425.285 280.447 405.785 256.547 425.785 209.847C427.585 205.547 430.985 200.647 434.985 194.847C441.485 185.347 450.285 172.447 450.985 163.147C451.385 158.347 449.885 154.847 446.385 152.147C439.185 146.647 426.585 146.147 418.985 148.947C404.185 154.247 398.185 169.547 391.885 185.647C387.685 196.347 383.385 207.347 376.185 215.447C367.085 225.647 354.985 229.647 339.985 227.447C321.985 224.747 311.385 216.847 308.485 204.047L308.385 203.747C302.385 177.747 322.685 155.447 338.485 140.947C352.185 128.347 366.685 113.647 364.385 98.2469C362.685 87.2469 353.185 77.2469 344.085 76.6469C307.785 74.6469 301.285 53.9469 296.985 40.2469C294.285 31.6469 292.785 27.9469 288.585 25.9469C268.785 16.5469 253.985 20.7469 233.985 41.2469C230.385 44.9469 227.285 49.3469 223.985 53.9469C219.185 60.7469 214.185 67.7469 207.085 73.5469C178.085 97.1469 149.085 93.0469 127.885 90.0469C120.485 89.0469 113.585 88.0469 107.885 88.3469C73.5849 90.0469 48.5849 99.6469 33.4849 116.947C24.6849 126.947 19.8849 143.247 21.3849 158.447C22.4849 169.747 27.4849 186.047 44.9849 199.547C76.6849 223.847 122.785 222.147 156.485 220.847C159.785 220.747 162.885 220.647 165.785 220.547C181.785 220.047 201.785 219.447 219.185 228.247C239.385 238.447 253.385 260.847 254.785 285.247C256.485 313.947 244.085 349.947 204.185 364.947C185.785 371.847 159.385 369.547 146.685 368.447C146.485 368.447 146.285 368.447 146.085 368.347C133.685 383.347 114.185 388.247 96.6849 392.647C82.7849 396.147 69.6849 399.447 60.1849 406.847C47.2849 416.847 40.2849 435.147 38.6849 462.847L38.0849 473.047ZM127.485 314.447C127.185 314.447 126.985 314.447 126.885 314.547C126.485 314.947 125.785 318.447 128.285 325.047C129.285 327.847 131.985 334.047 136.085 339.247C136.485 335.447 136.385 331.447 135.685 327.147C134.785 321.647 133.185 317.747 130.885 315.747C129.785 314.847 128.285 314.447 127.485 314.447Z"
              fill="white"
              fillOpacity="0.1"
            />
          </svg>
          <svg
            className={styles.posterBackground}
            width="466"
            height="176"
            viewBox="0 0 466 176"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M54.038 150.742H440.514C454.306 150.742 465.5 161.942 465.5 175.742V0.742188H0.768799C14.5608 0.742188 25.7543 11.9422 25.7543 25.7422V122.442C25.7543 138.042 38.347 150.742 54.038 150.742Z"
              fill="#F5F5F5"
            />
          </svg>

          <div className={styles.offerMainContent}>
            <div className={styles.mainContentLeft}>
              <div className={styles.offerFlexBlock}>
                <h2 className={styles.offerTitle}>
                  {block.title}{" "}
                  <span className={styles.offerTitleHighlight}>
                    {block.titleHighlight}
                  </span>
                </h2>
                <div className={styles.contentBlock}>
                  <PortableText
                    value={block.blockContent.content}
                    components={RichText}
                  />
                </div>
                <div className={styles.giftBlock}>
                  <div className={styles.giftImage}>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="40"
                      height="40"
                      viewBox="0 0 40 40"
                      fill="none"
                    >
                      <rect
                        y="-0.00463867"
                        width="40"
                        height="40"
                        rx="10"
                        fill="#224071"
                      />
                      <path
                        d="M27.0596 16.1582H25.554C25.8213 16.0209 26.0692 15.8486 26.2914 15.6463C26.949 15.0272 27.3199 14.163 27.3157 13.2599C27.312 12.3822 26.9404 11.5464 26.2914 10.9555C25.6298 10.3384 24.7586 9.99536 23.854 9.99536C22.9492 9.99536 22.0782 10.3384 21.4164 10.9555C20.6587 11.8425 20.156 12.9186 19.9621 14.069C19.7553 12.9309 19.2457 11.8696 18.4872 10.9965C17.8255 10.3794 16.9545 10.0364 16.0497 10.0364C15.145 10.0364 14.274 10.3794 13.6121 10.9965C12.9632 11.5874 12.5916 12.4232 12.588 13.3009C12.5837 14.2038 12.9548 15.0681 13.6121 15.6873C13.8343 15.8896 14.0823 16.0619 14.3496 16.1992H12.8646C12.3852 16.1908 11.9218 16.3705 11.5732 16.6999C11.2248 17.0291 11.0192 17.4817 11.0005 17.9608V28.2028C11.0113 28.6872 11.2134 29.1477 11.5627 29.4837C11.912 29.8194 12.3801 30.0033 12.8646 29.9951H27.0597C27.5442 30.0033 28.0123 29.8193 28.3615 29.4837C28.7108 29.1478 28.9129 28.6872 28.9238 28.2028V17.9608C28.9157 17.4745 28.7148 17.0114 28.3651 16.6735C28.0155 16.3354 27.5459 16.15 27.0597 16.1583L27.0596 16.1582ZM21.3346 14.9805C21.4964 13.9485 21.9001 12.9693 22.5125 12.123C22.8954 11.7644 23.4012 11.5666 23.9258 11.57C24.4263 11.5666 24.9095 11.7533 25.2778 12.0922C25.6121 12.3931 25.8054 12.8202 25.8103 13.27C25.8055 13.755 25.5974 14.2157 25.2368 14.54C24.3058 15.1327 23.2577 15.5171 22.1643 15.6666L21.0889 15.9125L21.3346 14.9805ZM14.6979 12.082C15.0662 11.743 15.5494 11.5565 16.0499 11.5598C16.5744 11.5563 17.0804 11.7544 17.4632 12.1129C18.0799 12.9616 18.4871 13.9443 18.6512 14.9805L18.9381 15.9126L17.9139 15.6667H17.9138C16.8204 15.5168 15.7724 15.1326 14.8412 14.54C14.4795 14.2201 14.2677 13.7634 14.2576 13.2803C14.2327 12.8373 14.3921 12.4037 14.6979 12.082ZM12.5369 28.2027V17.9606C12.5583 17.8003 12.7039 17.6865 12.8647 17.7046H18.9382V28.4585H12.8647C12.7039 28.4767 12.5583 28.3628 12.5369 28.2025V28.2027ZM27.3873 28.2027H27.3875C27.366 28.363 27.2205 28.4768 27.0596 28.4587H20.9861V17.6947H27.0596C27.2189 17.682 27.3612 17.7933 27.3875 17.9509L27.3873 28.2027Z"
                        fill="white"
                      />
                    </svg>
                  </div>
                  {block.giftText && (
                    <div className={styles.giftContent}>
                      <p className={styles.giftText}>{block.giftText}</p>
                    </div>
                  )}
                </div>
              </div>
              <div className={styles.offerDesctiption}>
                <p>{block.offerDescription}</p>
              </div>
            </div>
            <div className={styles.mainContenrRight}>
              <div className={styles.offerFormBlock}>
                <p className={styles.offerFormTitle}>{block.offerFormTitle}</p>
                {/* <FormSuperLite
                  form={block.offerForm}
                  offerButtonCustomText={block.offerButtonCustomText}
                /> */}
                <div className={styles.buttonBlock}>
                  <ButtonModal>{block.offerButtonCustomText}</ButtonModal>
                </div>
              </div>
              <div className={styles.offerLinksBlock}>
                <p className={styles.offerAltText}>{block.offerAltText}</p>
                <div className={styles.offerContactLinks}>
                  {block.offerContactLinks.map(link => (
                    <Link
                      key={link._key}
                      href={link.link}
                      target="_blank"
                      rel="noopener noreferrer"
                      className={styles.contactLink}
                    >
                      <Image
                        alt={link.title}
                        src={urlFor(link.icon).url()}
                        width={75}
                        height={75}
                        className={styles.contactIcon}
                      />
                    </Link>
                  ))}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
};

export default OfferBlockComponent;
